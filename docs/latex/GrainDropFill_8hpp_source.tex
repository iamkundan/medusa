\doxysection{Grain\+Drop\+Fill.\+hpp}
\hypertarget{GrainDropFill_8hpp_source}{}\label{GrainDropFill_8hpp_source}\index{include/medusa/bits/domains/GrainDropFill.hpp@{include/medusa/bits/domains/GrainDropFill.hpp}}
\mbox{\hyperlink{GrainDropFill_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00001}00001\ \textcolor{preprocessor}{\#ifndef\ MEDUSA\_BITS\_DOMAINS\_GRAINDROPFILL\_HPP\_}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00002}00002\ \textcolor{preprocessor}{\#define\ MEDUSA\_BITS\_DOMAINS\_GRAINDROPFILL\_HPP\_}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00009}00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{GrainDropFill__fwd_8hpp}{GrainDropFill\_fwd.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{randutils_8hpp}{medusa/bits/utils/randutils.hpp}}>}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{KDTree_8hpp}{medusa/bits/spatial\_search/KDTree.hpp}}>}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00012}00012\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{Grid_8hpp}{medusa/bits/spatial\_search/Grid.hpp}}>}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00013}00013\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{discretization__helpers_8hpp}{medusa/bits/domains/discretization\_helpers.hpp}}>}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00015}00015\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacemm}{mm}}\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00017}00017\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ vec\_t>}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00018}\mbox{\hyperlink{classmm_1_1GrainDropFill_a0d7275a2e314b8d72ddf83ab734b01c3}{00018}}\ \mbox{\hyperlink{classmm_1_1GrainDropFill_a0d7275a2e314b8d72ddf83ab734b01c3}{GrainDropFill<vec\_t>::GrainDropFill}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}\&\ bot,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}\&\ top)\ :}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00019}00019\ \ \ \ \ \ \ \ \ bot(bot),\ top(top),\ seed\_(\mbox{\hyperlink{group__utils_ga9f26c11aa51eea591d8ec9dba23d2bd2}{get\_seed}}())\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00020}00020\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ =\ 0;\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ <\ \mbox{\hyperlink{classmm_1_1GrainDropFill_afcc0da103765fa64c9461166b8293635a50e50c95e2b2329d7277d40a26c56e8c}{dim}};\ ++\mbox{\hyperlink{classmm_1_1Gaussian}{i}})\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00021}00021\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(\mbox{\hyperlink{classmm_1_1GrainDropFill_acd93248c48c470cf9cfbde30f105fc73}{top}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ >\ \mbox{\hyperlink{classmm_1_1GrainDropFill_aaca82d5e883ed2c0a07052a20044fed5}{bot}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}],\ \textcolor{stringliteral}{"{}Bottom\ must\ be\ less\ than\ top,\ got\ bot\ =\ \%s,\ top\ =\ \%s."{}},}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00022}00022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1GrainDropFill_aaca82d5e883ed2c0a07052a20044fed5}{bot}},\ \mbox{\hyperlink{classmm_1_1GrainDropFill_acd93248c48c470cf9cfbde30f105fc73}{top}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00023}00023\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00024}00024\ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00026}00026\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ vec\_t>}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00027}00027\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ func\_t>}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00028}\mbox{\hyperlink{classmm_1_1GrainDropFill_a44b89531a682455b9be8092967213a8d}{00028}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmm_1_1GrainDropFill_a44b89531a682455b9be8092967213a8d}{GrainDropFill<vec\_t>::operator()}}(\mbox{\hyperlink{classmm_1_1Gaussian}{DomainDiscretization<vec\_t>}}\&\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classmm_1_1Gaussian}{func\_t}}\&\ \mbox{\hyperlink{classmm_1_1Gaussian}{h}},}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ type)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ ==\ 0)\ type\ =\ 1;}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00031}00031\ \ \ \ \ std::vector<vec\_t>\ \mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}\ =\ fillBox(\mbox{\hyperlink{classmm_1_1Gaussian}{h}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00032}00032\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{KDTree<vec\_t>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_tree}}(\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.positions());}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00033}00033\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}\&\ p\ :\ \mbox{\hyperlink{classmm_1_1Gaussian}{nodes}})\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.contains(p,\ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_tree}}))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1GrainDropFill_a20c378526991aadb10bd9bc89acbdfd6}{scalar\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{r2}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_tree}}.query(p).second[0];}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00036}00036\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1GrainDropFill_a20c378526991aadb10bd9bc89acbdfd6}{scalar\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{allowed\_r}}\ =\ 0.75*\mbox{\hyperlink{classmm_1_1Gaussian}{h}}(p);}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{r2}}\ >=\ \mbox{\hyperlink{classmm_1_1Gaussian}{allowed\_r}}*\mbox{\hyperlink{classmm_1_1Gaussian}{allowed\_r}})\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.addInternalNode(p,\ type);}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00039}00039\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00040}00040\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00041}00041\ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00043}00043\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ vec\_t>}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00044}00044\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ func\_t>}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00045}\mbox{\hyperlink{classmm_1_1GrainDropFill_ab58564d3de3723e9fc0806eed15b1b37}{00045}}\ std::vector<vec\_t>\ \mbox{\hyperlink{classmm_1_1GrainDropFill_ab58564d3de3723e9fc0806eed15b1b37}{GrainDropFill<vec\_t>::fillBox}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classmm_1_1Gaussian}{func\_t}}\&\ \mbox{\hyperlink{classmm_1_1Gaussian}{h}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00046}00046\ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(dx\ >\ 0,\ \textcolor{stringliteral}{"{}Initial\ spacing\ must\ be\ positive,\ got\ \%g.\ Did\ you\ set\ it\ correctly?"{}},\ dx);}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00048}00048\ \ \ \ \ std::vector<vec\_t>\ \mbox{\hyperlink{classmm_1_1Gaussian}{result}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00050}00050\ \ \ \ \ \textcolor{comment}{//\ Initialization.}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00051}00051\ \ \ \ \ \mbox{\hyperlink{group__types_gabd14a97bbb66ac6c2add9c3db998b333}{Vec}}<\mbox{\hyperlink{classmm_1_1Gaussian}{int}},\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1>\ \mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00052}00052\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ =\ 0;\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ <\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1;\ ++\mbox{\hyperlink{classmm_1_1Gaussian}{i}})\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ =\ \mbox{\hyperlink{group__utils_ga3865c1d93dca35e836c70c17b2137bc3}{iceil}}((top[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ -\/\ bot[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}])\ /\ dx)\ +\ 1;}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(\mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ >=\ 1,\ \textcolor{stringliteral}{"{}Grid\ size\ in\ dimension\ \%d\ is\ not\ positive."{}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00055}00055\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00057}00057\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Grid}{Grid}}<\mbox{\hyperlink{classmm_1_1Gaussian_a485cc39648f69212e4c1bcef60e0f194}{scalar\_t}},\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1,\ \mbox{\hyperlink{classmm_1_1Gaussian}{int}},\ \mbox{\hyperlink{group__types_gabd14a97bbb66ac6c2add9c3db998b333}{Vec}}<\mbox{\hyperlink{classmm_1_1Gaussian}{int}},\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1>>\ \mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}(\mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}},\ bot[\mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1]);}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00058}00058\ \ \ \ \ Eigen::Map<Eigen::Matrix<scalar\_t,\ Eigen::Dynamic,\ 1>>}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00059}00059\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{eig\_z}}(\mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}.data().data(),\ \mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}.size());}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00060}00060\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{eig\_z}}\ +=\ 1\mbox{\hyperlink{classmm_1_1Gaussian}{e}}-\/4*dx*Eigen::Matrix<scalar\_t,\ Eigen::Dynamic,\ 1>::Random(\mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}.size());}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00062}00062\ \ \ \ \ \textcolor{comment}{//\ Main\ iteration\ loop.\ Find\ locally\ minimal\ point\ and\ raise\ its\ neighbourhood\ up.}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00063}00063\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_lin\_idx}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00064}00064\ \ \ \ \ \mbox{\hyperlink{classmm_1_1GrainDropFill_a20c378526991aadb10bd9bc89acbdfd6}{scalar\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_z}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{eig\_z}}.minCoeff(\&\mbox{\hyperlink{classmm_1_1Gaussian}{min\_lin\_idx}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00065}00065\ \ \ \ \ \mbox{\hyperlink{group__types_gabd14a97bbb66ac6c2add9c3db998b333}{Vec}}<\mbox{\hyperlink{classmm_1_1Gaussian}{int}},\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1>\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}.multiIndex(\mbox{\hyperlink{classmm_1_1Gaussian}{min\_lin\_idx}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00066}00066\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}\ p;}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00067}00067\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{dot\_nr}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00068}00068\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{dot\_nr}}\ <\ max\_points\ \&\&\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_z}}\ <=\ top[\mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1]\ +\ excess\_factor*dx)\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00069}00069\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ new\ point.}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00070}00070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ =\ 0;\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ <\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1;\ ++\mbox{\hyperlink{classmm_1_1Gaussian}{i}})\ p[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ =\ bot[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ +\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ *\ dx;}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00071}00071\ \ \ \ \ \ \ \ \ p[\mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1]\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_z}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00072}00072\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{result}}.push\_back(p);}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00073}00073\ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{classmm_1_1Gaussian}{dot\_nr}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ heights\ of\ neighbours.}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1GrainDropFill_a20c378526991aadb10bd9bc89acbdfd6}{scalar\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{r}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{h}}(p);}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{idx\_rad}}\ =\ \mbox{\hyperlink{group__utils_ga8b0dd3e08714a12183860dc7db758344}{ifloor}}(\mbox{\hyperlink{classmm_1_1Gaussian}{r}}\ /\ dx);}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__types_gabd14a97bbb66ac6c2add9c3db998b333}{Vec}}<\mbox{\hyperlink{classmm_1_1Gaussian}{int}},\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1>\ \mbox{\hyperlink{classmm_1_1Gaussian}{low}}\ =\ (\mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}\ -\/\ \mbox{\hyperlink{group__types_gabd14a97bbb66ac6c2add9c3db998b333}{Vec<int,\ dim-\/1>::Constant}}(\mbox{\hyperlink{classmm_1_1Gaussian}{idx\_rad}})).\mbox{\hyperlink{classmm_1_1Gaussian}{cwiseMax}}(0);}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__types_gabd14a97bbb66ac6c2add9c3db998b333}{Vec}}<\mbox{\hyperlink{classmm_1_1Gaussian}{int}},\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1>\ \mbox{\hyperlink{classmm_1_1Gaussian}{high}}\ =\ (\mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}\ +\ \mbox{\hyperlink{group__types_gabd14a97bbb66ac6c2add9c3db998b333}{Vec<int,\ dim-\/1>::Constant}}(\mbox{\hyperlink{classmm_1_1Gaussian}{idx\_rad}}+1)).\mbox{\hyperlink{classmm_1_1Gaussian}{cwiseMin}}(\mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__types_gabd14a97bbb66ac6c2add9c3db998b333}{Vec}}<\mbox{\hyperlink{classmm_1_1Gaussian}{int}},\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1>\ \mbox{\hyperlink{classmm_1_1Gaussian}{cnt}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{low}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{cnt\_lin}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1GrainDropFill_a20c378526991aadb10bd9bc89acbdfd6}{scalar\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{height\_update}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{r}}*\mbox{\hyperlink{classmm_1_1Gaussian}{r}}-\/((\mbox{\hyperlink{classmm_1_1Gaussian}{cnt}}-\/\mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}).\textcolor{keyword}{template}\ \mbox{\hyperlink{classmm_1_1Gaussian}{cast<scalar\_t>}}()*dx).\mbox{\hyperlink{classmm_1_1Gaussian}{squaredNorm}}();}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{cnt\_lin}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}.linearIndex(\mbox{\hyperlink{classmm_1_1Gaussian}{cnt}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{height\_update}}\ >\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}[\mbox{\hyperlink{classmm_1_1Gaussian}{cnt\_lin}}]\ =\ std::max(\mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}[\mbox{\hyperlink{classmm_1_1Gaussian}{cnt\_lin}}],\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_z}}\ +\ std::sqrt(\mbox{\hyperlink{classmm_1_1Gaussian}{height\_update}}));}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00088}00088\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{group__utils_ga3d998a49d777996d2276aa160c9dc769}{incrementCounter}}(\mbox{\hyperlink{classmm_1_1Gaussian}{cnt}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{low}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{high}}));}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00089}00089\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_z}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}[\mbox{\hyperlink{classmm_1_1Gaussian}{min\_lin\_idx}}];\ \ \textcolor{comment}{//\ Update\ minimum\ to\ be\ able\ to\ find\ something\ smaller\ later.}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00091}00091\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ next\ local\ minimum}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00092}00092\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{dist}}\ =\ 2*\mbox{\hyperlink{classmm_1_1Gaussian}{idx\_rad}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00093}00093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{dist}}\ >\ \mbox{\hyperlink{classmm_1_1Gaussian}{idx\_rad}})\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ =\ 0;\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ <\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}-\/1;\ ++\mbox{\hyperlink{classmm_1_1Gaussian}{i}})\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{low}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ =\ (((\mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ -\/\ 2*\mbox{\hyperlink{classmm_1_1Gaussian}{idx\_rad}})\ \%\ \mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}])\ +\ \mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}])\ \%\ \mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}];}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{high}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ =\ (\mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}]\ +\ 2*\mbox{\hyperlink{classmm_1_1Gaussian}{idx\_rad}}\ +\ 1)\ \%\ \mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}}[\mbox{\hyperlink{classmm_1_1Gaussian}{i}}];}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classmm_1_1Gaussian}{old\_min\_idx}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{cnt}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{low}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{cnt\_lin}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}.linearIndex(\mbox{\hyperlink{classmm_1_1Gaussian}{cnt}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}[\mbox{\hyperlink{classmm_1_1Gaussian}{cnt\_lin}}]\ <\ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_z}})\ \{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_z}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{z\_coor}}[\mbox{\hyperlink{classmm_1_1Gaussian}{cnt\_lin}}];}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_lin\_idx}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{cnt\_lin}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{cnt}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{group__utils_gac53466280b26b3e911ab80c2f831ae49}{incrementCyclicCounter}}(\mbox{\hyperlink{classmm_1_1Gaussian}{cnt}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{low}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{high}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{grid\_size}}));}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{dist}}\ =\ (\mbox{\hyperlink{classmm_1_1Gaussian}{min\_idx}}\ -\/\ \mbox{\hyperlink{classmm_1_1Gaussian}{old\_min\_idx}}).\mbox{\hyperlink{classmm_1_1Gaussian}{cwiseAbs}}().maxCoeff();}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00109}00109\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00110}00110\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00111}00111\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classmm_1_1Gaussian}{result}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00112}00112\ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00113}00113\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00115}00115\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00116}00116\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ func\_t>}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00117}\mbox{\hyperlink{classmm_1_1GrainDropFill_aa1596fff0fbe52ad46e2c985ef777b84}{00117}}\ std::vector<Vec1d>\ \mbox{\hyperlink{classmm_1_1GrainDropFill_ab58564d3de3723e9fc0806eed15b1b37}{GrainDropFill<Vec1d>::fillBox}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classmm_1_1Gaussian}{func\_t}}\&\ \mbox{\hyperlink{classmm_1_1Gaussian}{h}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00118}00118\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classmm_1_1Gaussian}{result}}\ =\ \mbox{\hyperlink{group__domains_ga512df82fe796b64942e99d10f4d66328}{discretization\_helpers::discretizeLineWithDensity}}(bot,\ top,\ \mbox{\hyperlink{classmm_1_1Gaussian}{h}});}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00119}00119\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{result}}.resize(std::min(\mbox{\hyperlink{classmm_1_1Gaussian}{result}}.size(),\ max\_points));}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00120}00120\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classmm_1_1Gaussian}{result}};}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00121}00121\ \}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00123}00123\ \}\ \ \textcolor{comment}{//\ namespace\ mm}}
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{GrainDropFill_8hpp_source_l00125}00125\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ MEDUSA\_BITS\_DOMAINS\_GRAINDROPFILL\_HPP\_}}

\end{DoxyCode}
