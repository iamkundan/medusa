\doxysection{Basic\+Relax.\+hpp}
\hypertarget{BasicRelax_8hpp_source}{}\label{BasicRelax_8hpp_source}\index{include/medusa/bits/domains/BasicRelax.hpp@{include/medusa/bits/domains/BasicRelax.hpp}}
\mbox{\hyperlink{BasicRelax_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00001}00001\ \textcolor{preprocessor}{\#ifndef\ MEDUSA\_BITS\_DOMAINS\_BASICRELAX\_HPP\_}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00002}00002\ \textcolor{preprocessor}{\#define\ MEDUSA\_BITS\_DOMAINS\_BASICRELAX\_HPP\_}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{BasicRelax__fwd_8hpp}{BasicRelax\_fwd.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{assert_8hpp}{medusa/bits/utils/assert.hpp}}>}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{Range_8hpp}{medusa/bits/types/Range.hpp}}>}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{KDTree_8hpp}{medusa/bits/spatial\_search/KDTree.hpp}}>}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00008}00008\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{KDTreeMutable_8hpp}{medusa/bits/spatial\_search/KDTreeMutable.hpp}}>}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00015}00015\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacemm}{mm}}\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00018}00018\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ domain\_t,\ \textcolor{keyword}{class}\ radius\_func\_type>}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00019}\mbox{\hyperlink{classmm_1_1BasicRelax_aab94fff4aa61eed91f638798dc3953be}{00019}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmm_1_1BasicRelax_a88f547db8a2ea2b1c662b6dc11057369}{BasicRelax::operator()}}(domain\_t\&\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classmm_1_1Gaussian}{radius\_func\_type}}\&\ \mbox{\hyperlink{classmm_1_1Gaussian}{r\_func}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00020}00020\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ domain\_t::vector\_t\ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00021}00021\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ domain\_t::scalar\_t\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a695df4b7223929a38bb9cec692d413b5}{scalar\_t}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00022}00022\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}}\ =\ domain\_t::dim;}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00024}00024\ \ \ \ \ \textcolor{comment}{//\ if\ no\ nodes\ are\ supplied,\ all\ interior\ nodes\ are\ processed}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00025}00025\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}\ =\ (\mbox{\hyperlink{classmm_1_1BasicRelax_a86e9a4f4fc113a241efd1a5c4a6cb782}{nodes\_}}.empty())\ ?\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\textcolor{keyword}{>}(\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.interior())\ :\ \mbox{\hyperlink{classmm_1_1BasicRelax_a86e9a4f4fc113a241efd1a5c4a6cb782}{nodes\_}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00027}00027\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{N}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.size();}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00028}00028\ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(\mbox{\hyperlink{classmm_1_1Gaussian}{N}}\ >\ \mbox{\hyperlink{classmm_1_1BasicRelax_ab3d2afcee1b0617a428dfa002e749b26}{num\_neighbours}},\ \textcolor{stringliteral}{"{}Cannot\ relax\ a\ domain\ with\ less\ that\ num\_neighbours\ nodes,\ "{}}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}num\_neighbours\ =\ \%d,\ N\ =\ \%d."{}},\ \mbox{\hyperlink{classmm_1_1BasicRelax_ab3d2afcee1b0617a428dfa002e749b26}{num\_neighbours}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{N}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00030}00030\ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(\mbox{\hyperlink{classmm_1_1BasicRelax_ab3d2afcee1b0617a428dfa002e749b26}{num\_neighbours}}\ >=\ 1,\ \textcolor{stringliteral}{"{}At\ least\ two\ neighbours\ are\ required,\ got\ \%d."{}},}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1BasicRelax_ab3d2afcee1b0617a428dfa002e749b26}{num\_neighbours}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00032}00032\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ :\ \mbox{\hyperlink{classmm_1_1Gaussian}{nodes}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00033}00033\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(0\ <=\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ \&\&\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ <\ \mbox{\hyperlink{classmm_1_1Gaussian}{N}},\ \textcolor{stringliteral}{"{}Node\ index\ \%d\ out\ of\ range\ [0,\ \%d)\ in\ relax."{}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{N}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00034}00034\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00036}00036\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.boundary();}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00037}00037\ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(!\mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}.empty(),\ \textcolor{stringliteral}{"{}Relax\ requires\ boundary\ nodes,\ but\ this\ domain\ has\ none!"{}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00038}00038\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{KDTreeMutable<vec\_t>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_tree}}(\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.positions()[\mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}]);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00039}00039\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{KDTree<vec\_t>}}\ tree;}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00040}00040\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{indices}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00042}00042\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{to\_delete}}\ =\ \{\};\ \ \textcolor{comment}{//\ nodes\ to\ be\ deleted\ from\ domain\ after\ relax}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00043}00043\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classmm_1_1Gaussian}{removed\_nodes\_warning}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00045}00045\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ \mbox{\hyperlink{classmm_1_1BasicRelax_ad49fc5ee6414873bb491eb3888e847e4}{num\_iterations}};\ ++c)\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ 0\ ||\ c\ \%\ \mbox{\hyperlink{classmm_1_1BasicRelax_a5a0cba7fbe60728375baf0347230e7d8}{rebuild\_tree\_after}}\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ tree.reset(\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.positions());}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00048}00048\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ nodes\ to\ be\ removed\ from\ relax\ procedure}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00050}00050\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{to\_remove}}\ =\ \{\};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Annealing\ factor\ -\/-\/\ depends\ only\ on\ iteration\ step}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classmm_1_1Gaussian}{a\_f}}\ =\ ((\mbox{\hyperlink{classmm_1_1BasicRelax_a82137f81f9060ab3468d6f9c8709efa9}{initial\_heat}}\ -\/\ \mbox{\hyperlink{classmm_1_1BasicRelax_acf63d67279761f418b021d8de496aed1}{final\_heat}})\ *\ (\mbox{\hyperlink{classmm_1_1BasicRelax_ad49fc5ee6414873bb491eb3888e847e4}{num\_iterations}}\ -\/\ c)\ /\ \mbox{\hyperlink{classmm_1_1BasicRelax_ad49fc5ee6414873bb491eb3888e847e4}{num\_iterations}}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ \mbox{\hyperlink{classmm_1_1BasicRelax_acf63d67279761f418b021d8de496aed1}{final\_heat}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Range\ of\ all\ displacements}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00055}00055\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<vec\_t>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}(\mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}.size(),\ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}(0.0));}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00056}00056\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{k}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00057}00057\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \#if\ defined(\_OPENMP)}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00058}00058\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ omp\ parallel\ for\ private(k)\ schedule(static)}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ before\ enabling\ openmp\ vectors\ to\_delete\ and\ to\_remove}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ have\ to\ be\ introduced\ for\ each\ thread\ and\ combined\ at\ the\ end\ of\ the\ loop}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ otherwise\ expect\ se.g.\(\backslash\)\ fault}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00062}00062\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{k}}\ =\ 0;\ \mbox{\hyperlink{classmm_1_1Gaussian}{k}}\ <\ \mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}.size();\ ++\mbox{\hyperlink{classmm_1_1Gaussian}{k}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}];}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.type(\mbox{\hyperlink{classmm_1_1Gaussian}{i}})\ >\ 0,\ \textcolor{stringliteral}{"{}Only\ interior\ nodes\ are\ to\ be\ relaxed"{}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}\ pos\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.pos(\mbox{\hyperlink{classmm_1_1Gaussian}{i}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{indices}}\ =\ tree.query(pos,\ \mbox{\hyperlink{classmm_1_1BasicRelax_ab3d2afcee1b0617a428dfa002e749b26}{num\_neighbours}}\ +\ 1).first;}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classmm_1_1Gaussian}{d0}}\ =\ std::pow((\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.pos(\mbox{\hyperlink{classmm_1_1Gaussian}{indices}}[1])\ -\/\ pos).norm(),\ 1.0\ /\ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a4caf8d8f829279fba122163d961608a4adab4fc5cf28f3e6da4c0cbec125fce6f}{dim}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop\ over\ support\ and\ compute\ potential\ contributions}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MatrixBaseAddons_8hpp_a695df4b7223929a38bb9cec692d413b5}{scalar\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{r\_0}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{j}}\ =\ 1;\ \mbox{\hyperlink{classmm_1_1Gaussian}{j}}\ <\ \mbox{\hyperlink{classmm_1_1Gaussian}{indices}}.size();\ ++\mbox{\hyperlink{classmm_1_1Gaussian}{j}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ central\ node\ to\ support\ nodes\ vector}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{r}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.pos(\mbox{\hyperlink{classmm_1_1Gaussian}{indices}}[\mbox{\hyperlink{classmm_1_1Gaussian}{j}}])\ -\/\ pos;}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(\mbox{\hyperlink{classmm_1_1Gaussian}{r}}.norm()\ >\ 1\mbox{\hyperlink{classmm_1_1Gaussian}{e}}-\/15,\ \textcolor{stringliteral}{"{}Nodes\ \%d\ and\ \%d\ have\ the\ same\ coordinates\ \%s.\ "{}}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Try\ using\ lower\ initial\ heat."{}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{i}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{indices}}[\mbox{\hyperlink{classmm_1_1Gaussian}{j}}],\ pos);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ potential\ gradient}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ target\ density\ in\ terms\ of\ radius\ to\ the\ closest\ node}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{r\_0}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{r\_func}}(\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.pos(\mbox{\hyperlink{classmm_1_1Gaussian}{indices}}[\mbox{\hyperlink{classmm_1_1Gaussian}{j}}]));}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}]\ +=\ std::pow(std::abs(\mbox{\hyperlink{classmm_1_1Gaussian}{r\_0}})\ /\ \mbox{\hyperlink{classmm_1_1Gaussian}{r}}.norm(),\ \mbox{\hyperlink{classmm_1_1BasicRelax_a83640d548d2e0be47968a56a0bb37eed}{potential\_order}})\ *\ \mbox{\hyperlink{classmm_1_1Gaussian}{r}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ no-\/distribution\ mode}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{r\_0}}\ <\ 0)\ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}]\ =\ 0.2\ *\ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}].normalized()\ *\ \mbox{\hyperlink{classmm_1_1Gaussian}{a\_f}}\ *\ \mbox{\hyperlink{classmm_1_1Gaussian}{d0}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}]\ =\ -\/\mbox{\hyperlink{classmm_1_1Gaussian}{a\_f}}\ *\ \mbox{\hyperlink{classmm_1_1Gaussian}{d0}}\ *\ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}];}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Project\ escaped\ nodes\ on\ the\ boundary}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.\mbox{\hyperlink{classmm_1_1Gaussian_ab19078ff5c4e16b19eaf66ba8736ebf5}{shape}}().contains(pos\ +\ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}]))\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{tmp}},\ normal;\ \ \textcolor{comment}{//\ projection\ temp\ variables}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classmm_1_1Gaussian}{project}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{classmm_1_1BasicRelax_aa054d3465d9b5190b5ef67b779d8dba1}{projection\_type}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{classmm_1_1BasicRelax_ad9c85f150b8c149ae8ae3316fce67695a9cba8855c66ddbfc7769282ceaf48e87}{DO\_NOT\_PROJECT}}:\ \ \textcolor{comment}{//\ mark\ escaped\ nodes\ for\ deletion}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{to\_remove}}.push\_back(\mbox{\hyperlink{classmm_1_1Gaussian}{k}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{to\_delete}}.push\_back(\mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}]);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{project}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{classmm_1_1BasicRelax_ad9c85f150b8c149ae8ae3316fce67695a3d97f43b62a22f5dc91fd7eb9ba86b85}{PROJECT\_IN\_DIRECTION}}:\ \ \textcolor{comment}{//\ project\ on\ boundary\ in\ direction\ of\ relax}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{tmp}}\ =\ 0.5\ *\ (2\ *\ pos\ +\ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}]);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normal\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}].normalized();}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{classmm_1_1BasicRelax_ad9c85f150b8c149ae8ae3316fce67695aa27f8899840416e18ae6be1172712f3b}{PROJECT\_BETWEEN\_CLOSEST}}:\ \ \textcolor{comment}{//\ project\ between\ closest\ nodes\ on\ boundary}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{idx}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_tree}}.query(pos,\ 2).first;}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{s}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}[\mbox{\hyperlink{classmm_1_1Gaussian}{idx}}[0]],\ t\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}[\mbox{\hyperlink{classmm_1_1Gaussian}{idx}}[1]];}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{tmp}}\ =\ 0.5\ *\ (\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.pos(\mbox{\hyperlink{classmm_1_1Gaussian}{s}})\ +\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.pos(t));}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normal\ =\ (0.5\ *\ (\mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.normal(\mbox{\hyperlink{classmm_1_1Gaussian}{s}})\ +\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.normal(t))).normalized();}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ projection\ method\ selection\ end}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{project}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ performs\ actual\ projection}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classmm_1_1Gaussian}{success}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{vec\_t}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{proj}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::tie(\mbox{\hyperlink{classmm_1_1Gaussian}{success}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{proj}})\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.\mbox{\hyperlink{classmm_1_1Gaussian_ab19078ff5c4e16b19eaf66ba8736ebf5}{shape}}().projectPointToBoundary(\mbox{\hyperlink{classmm_1_1Gaussian}{tmp}},\ normal);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{success}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ if\ projected\ node\ is\ not\ too\ close\ to\ boundary\ node}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<double>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{dist}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\ \mbox{\hyperlink{classmm_1_1Gaussian}{ind}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::tie(\mbox{\hyperlink{classmm_1_1Gaussian}{ind}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{dist}})\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_tree}}.query(\mbox{\hyperlink{classmm_1_1Gaussian}{proj}},\ 2);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::sqrt(\mbox{\hyperlink{classmm_1_1Gaussian}{dist}}[0]\ /\ \mbox{\hyperlink{classmm_1_1Gaussian}{dist}}[1])\ <\ \mbox{\hyperlink{classmm_1_1BasicRelax_af307d1fd61c9dec303b9429f599df8e2}{boundary\_projection\_threshold}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}]\ =\ -\/\mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}];}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classmm_1_1Gaussian}{d\_1}}\ =\ std::sqrt(\mbox{\hyperlink{classmm_1_1Gaussian}{dist}}[0]);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classmm_1_1Gaussian}{d\_2}}\ =\ std::sqrt(\mbox{\hyperlink{classmm_1_1Gaussian}{dist}}[1]);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classmm_1_1Gaussian}{d\_0}}\ =\ std::sqrt(\mbox{\hyperlink{classmm_1_1Gaussian}{dist}}[0]\ +\ \mbox{\hyperlink{classmm_1_1Gaussian}{dist}}[1]);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ normal\ =\ ((1\ -\/\ \mbox{\hyperlink{classmm_1_1Gaussian}{d\_1}}\ /\ \mbox{\hyperlink{classmm_1_1Gaussian}{d\_0}})\ *\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.normal(\mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}[\mbox{\hyperlink{classmm_1_1Gaussian}{ind}}[0]])}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ (1\ -\/\ \mbox{\hyperlink{classmm_1_1Gaussian}{d\_2}}\ /\ \mbox{\hyperlink{classmm_1_1Gaussian}{d\_0}})\ *\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.normal(\mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}[\mbox{\hyperlink{classmm_1_1Gaussian}{ind}}[1]])).\mbox{\hyperlink{classmm_1_1Gaussian}{normalized}}();}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_type}}\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.type(\mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}[\mbox{\hyperlink{classmm_1_1Gaussian}{ind}}[0]]);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.changeToBoundary(\mbox{\hyperlink{classmm_1_1Gaussian}{i}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{proj}},\ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_type}},\ normal);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{boundary\_tree}}.insert(\mbox{\hyperlink{classmm_1_1Gaussian}{proj}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{bnd}}.push\_back(\mbox{\hyperlink{classmm_1_1Gaussian}{i}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ mark\ projected\ node\ to\ be\ removed\ from\ the\ list\ for\ relax}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{to\_remove}}.push\_back(\mbox{\hyperlink{classmm_1_1Gaussian}{k}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{removed\_nodes\_warning}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ projection\ failed,\ remove\ node}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{to\_remove}}.push\_back(\mbox{\hyperlink{classmm_1_1Gaussian}{k}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{to\_delete}}.push\_back(\mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}]);}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ project\ if\ end}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ escaped\ nodes\ if\ end}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00139}00139\ \ \ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ spatial\ loop\ end}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00140}00140\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}.remove(\mbox{\hyperlink{classmm_1_1Gaussian}{to\_remove}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00141}00141\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{assert_8hpp_a67c64a8e3a60557627922c88b087d484}{assert\_msg}}(\mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}.size()\ >\ \mbox{\hyperlink{classmm_1_1BasicRelax_ab3d2afcee1b0617a428dfa002e749b26}{num\_neighbours}}\ +\ 1,}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}No\ nodes\ in\ relax\ pool\ anymore,\ perhaps\ use\ lower\ heat"{}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ displacement}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00144}00144\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \#if\ defined(\_OPENMP)}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \#pragma\ omp\ parallel\ for\ private(k)\ schedule(static)}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \#endif}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{k}}\ =\ 0;\ \mbox{\hyperlink{classmm_1_1Gaussian}{k}}\ <\ \mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}.size();\ ++\mbox{\hyperlink{classmm_1_1Gaussian}{k}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.pos(\mbox{\hyperlink{classmm_1_1Gaussian}{nodes}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}])\ +=\ \mbox{\hyperlink{classmm_1_1Gaussian}{dp}}[\mbox{\hyperlink{classmm_1_1Gaussian}{k}}];}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00149}00149\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00150}00150\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ DEBUG\ OUT\ -\/-\/\ for\ plotting}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ debug\_out\ <<\ "{}nodes("{}\ <<\ c\ +\ 1\ <<\ "{},:,:)="{}\ <<\ domain.positions\ <<\ "{};\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00152}00152\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00153}00153\ \ \ \ \ \textcolor{comment}{//\ remove\ nodes\ at\ the\ end\ of\ relax\ to\ avoid\ mess\ with\ indices}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00154}00154\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.removeNodes(\mbox{\hyperlink{classmm_1_1Gaussian}{to\_delete}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00155}00155\ \textcolor{preprocessor}{\ \ \ \ \#if\ 0\ \ }\textcolor{comment}{//\ debug}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00156}00156\ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{debug\_out}}\ <<\ \textcolor{stringliteral}{"{}nodes\_final(:,:)="{}}\ <<\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.positions\ <<\ \textcolor{stringliteral}{"{};\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00157}00157\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{debug\_out}}\ <<\ \textcolor{stringliteral}{"{}normal\ ="{}}\ <<\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.normals()\ <<\ \textcolor{stringliteral}{"{};\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00158}00158\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{Range<int>}}\ boundary\ =\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.types\ <\ 0;}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00159}00159\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{debug\_out}}\ <<\ \textcolor{stringliteral}{"{}boundary\ ="{}}\ <<\ boundary\ <<\ \textcolor{stringliteral}{"{};\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00160}00160\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{debug\_out}}\ <<\ \textcolor{stringliteral}{"{}boundary\_map\ ="{}}\ <<\ \mbox{\hyperlink{classmm_1_1Gaussian}{domain}}.boundary\_map()\ <<\ \textcolor{stringliteral}{"{};\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00161}00161\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmm_1_1Gaussian}{debug\_out}}.close();}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00162}00162\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00163}00163\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmm_1_1Gaussian}{removed\_nodes\_warning}})\ \{}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00164}00164\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacemm_a48aee295207b24394af5ed5ae764c662}{print\_red}}(\textcolor{stringliteral}{"{}warning\ -\/-\/\ nodes\ removed\ during\ relax\ due\ to\ projection\ fail\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00165}00165\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00166}00166\ \}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00168}00168\ \}\ \ \textcolor{comment}{//\ namespace\ mm}}
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{BasicRelax_8hpp_source_l00170}00170\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ MEDUSA\_BITS\_DOMAINS\_BASICRELAX\_HPP\_}}

\end{DoxyCode}
