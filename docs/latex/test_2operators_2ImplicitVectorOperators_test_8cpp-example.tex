\doxysection{test/operators/\+Implicit\+Vector\+Operators\+\_\+test.\+cpp}
\hypertarget{test_2operators_2ImplicitVectorOperators_test_8cpp-example}{}\label{test_2operators_2ImplicitVectorOperators_test_8cpp-example}
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{Gaussian__fwd_8hpp}{medusa/bits/approximations/Gaussian\_fwd.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{JacobiSVDWrapper__fwd_8hpp}{medusa/bits/approximations/JacobiSVDWrapper\_fwd.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{Monomials_8hpp}{medusa/bits/approximations/Monomials.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{WeightFunction__fwd_8hpp}{medusa/bits/approximations/WeightFunction\_fwd.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{WLS__fwd_8hpp}{medusa/bits/approximations/WLS\_fwd.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{BoxShape__fwd_8hpp}{medusa/bits/domains/BoxShape\_fwd.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{DomainDiscretization__fwd_8hpp}{medusa/bits/domains/DomainDiscretization\_fwd.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{FindClosest_8hpp}{medusa/bits/domains/FindClosest.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{computeShapes_8hpp}{medusa/bits/operators/computeShapes.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ImplicitVectorOperators_8hpp}{medusa/bits/operators/ImplicitVectorOperators.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{RaggedShapeStorage_8hpp}{medusa/bits/operators/RaggedShapeStorage.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ShapeStorage_8hpp}{medusa/bits/operators/ShapeStorage.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{UniformShapeStorage_8hpp}{medusa/bits/operators/UniformShapeStorage.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{Vec_8hpp}{medusa/bits/types/Vec.hpp}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}gtest/gtest.h"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <Eigen/SparseCore>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <Eigen/IterativeLinearSolvers>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <Eigen/SparseLU>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacemm}{mm}}\ \{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{class\ }ImplicitVecOp\ :\ \textcolor{keyword}{public}\ ::testing::Test\ \{}
\DoxyCodeLine{\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{\ \ \ \ UniformShapeStorage<Vec2d>\ shapes;}
\DoxyCodeLine{\ \ \ \ Eigen::Matrix<double,\ 6,\ 6>\ M;}
\DoxyCodeLine{\ \ \ \ Eigen::Matrix<double,\ 6,\ 1>\ rhs;}
\DoxyCodeLine{\ \ \ \ ImplicitVectorOperators<\textcolor{keyword}{decltype}(shapes),\ \textcolor{keyword}{decltype}(M),\ \textcolor{keyword}{decltype}(rhs)>\ op;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{void}\ SetUp()\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.resize(\{3,\ 3,\ 3\});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setSupport(0,\ \{0,\ 1,\ 2\});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setSupport(1,\ \{0,\ 1,\ 2\});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setSupport(2,\ \{0,\ 1,\ 2\});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ M.setZero();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ rhs.setZero();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Eigen::Vector3d\ s0(1.2,\ 1.3,\ 1.4),\ s1(-\/14,\ -\/15,\ -\/16),\ s2(100,\ 110,\ 120);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setLaplace(0,\ s0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setLaplace(1,\ s1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setLaplace(2,\ s2);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Eigen::Vector3d\ d0(1200,\ 1300,\ 1400),\ d1(-\/14000,\ -\/15000,\ -\/16000),\ d2(0.01,\ 0.011,\ 0.012);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD1(0,\ 0,\ d0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD1(0,\ 1,\ d1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD1(0,\ 2,\ d2);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD1(1,\ 0,\ 2*d0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD1(1,\ 1,\ 2*d1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD1(1,\ 2,\ 2*d2);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Eigen::Vector3d\ dd0(0.5,\ 0.6,\ 0.7),\ dd1(-\/1.4,\ -\/1.5,\ -\/1.6),\ dd2(-\/25,\ -\/26,\ -\/27);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(0,\ 0,\ 0,\ dd0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(0,\ 0,\ 1,\ dd1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(0,\ 0,\ 2,\ dd2);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(0,\ 1,\ 0,\ 2*dd0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(0,\ 1,\ 1,\ 2*dd1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(0,\ 1,\ 2,\ 2*dd2);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(1,\ 1,\ 0,\ 3*dd0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(1,\ 1,\ 1,\ 3*dd1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setD2(1,\ 1,\ 2,\ 3*dd2);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op\ =\ shapes.implicitVectorOperators(M,\ rhs);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ AssignTwice)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedM\ =\ M;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedRhs\ =\ rhs;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ expectedM(0,\ 0)\ =\ 1;}
\DoxyCodeLine{\ \ \ \ expectedM(3,\ 3)\ =\ 1;}
\DoxyCodeLine{\ \ \ \ expectedRhs[0]\ =\ 1;}
\DoxyCodeLine{\ \ \ \ expectedRhs[3]\ =\ 1;}
\DoxyCodeLine{\ \ \ \ op.value(0)\ =\ 1;}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedM\ -\/\ M).lpNorm<1>());}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ expectedM(0,\ 0)\ =\ 2;}
\DoxyCodeLine{\ \ \ \ expectedM(3,\ 3)\ =\ 2;}
\DoxyCodeLine{\ \ \ \ expectedRhs[0]\ =\ 2;}
\DoxyCodeLine{\ \ \ \ expectedRhs[3]\ =\ 2;}
\DoxyCodeLine{\ \ \ \ op.value(0)\ =\ 1;}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedM\ -\/\ M).lpNorm<1>());}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ AssignCombined)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ v\ =\ 4.2;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedM\ =\ M;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedRhs\ =\ rhs;}
\DoxyCodeLine{\ \ \ \ op.value(1)\ +\ v\ *\ op.lap(1)\ +\ op.value(1)\ =\ \{v,\ 2*v\};}
\DoxyCodeLine{\ \ \ \ expectedM.row(1).head(3)\ +=\ v\ *\ shapes.laplace(1);}
\DoxyCodeLine{\ \ \ \ expectedM.row(4).tail(3)\ +=\ v\ *\ shapes.laplace(1);}
\DoxyCodeLine{\ \ \ \ expectedM(1,\ 1)\ +=\ 2;}
\DoxyCodeLine{\ \ \ \ expectedM(4,\ 4)\ +=\ 2;}
\DoxyCodeLine{\ \ \ \ expectedRhs[1]\ =\ v;}
\DoxyCodeLine{\ \ \ \ expectedRhs[4]\ =\ 2*v;}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedM\ -\/\ M).lpNorm<1>());}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ AssignValue)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ v\ =\ 4.2,\ f\ =\ -\/3.4;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedM\ =\ M;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedRhs\ =\ rhs;}
\DoxyCodeLine{\ \ \ \ expectedM(1,\ 1)\ =\ f;}
\DoxyCodeLine{\ \ \ \ expectedM(4,\ 4)\ =\ f;}
\DoxyCodeLine{\ \ \ \ expectedRhs[1]\ =\ v;}
\DoxyCodeLine{\ \ \ \ expectedRhs[4]\ =\ 2*v;}
\DoxyCodeLine{\ \ \ \ f*op.value(1)\ =\ \{v,\ 2*v\};}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedM\ -\/\ M).lpNorm<1>());}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ AssignLap)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ v\ =\ 4.2;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedM\ =\ M;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedRhs\ =\ rhs;}
\DoxyCodeLine{\ \ \ \ expectedM.row(0).head(3)\ =\ shapes.laplace(0);}
\DoxyCodeLine{\ \ \ \ expectedM.row(3).tail(3)\ =\ shapes.laplace(0);}
\DoxyCodeLine{\ \ \ \ expectedRhs[0]\ =\ v;}
\DoxyCodeLine{\ \ \ \ expectedRhs[3]\ =\ 2*v;}
\DoxyCodeLine{\ \ \ \ op.lap(0)\ =\ \{v,\ 2*v\};}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedM\ -\/\ M).lpNorm<1>());}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ AssignGrad)\ \{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\ direction(3.4,\ 2.4);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ v\ =\ 4.2,\ v\_row\ =\ 5.3;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedM\ =\ M;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedRhs\ =\ rhs;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ expectedM.row(0).head(3)\ =\ direction[0]*shapes.d1(0,\ 0)\ +\ direction[1]*shapes.d1(1,\ 0);}
\DoxyCodeLine{\ \ \ \ expectedM.row(1).head(3)\ =\ direction[0]*shapes.d1(0,\ 0)\ +\ direction[1]*shapes.d1(1,\ 0);}
\DoxyCodeLine{\ \ \ \ expectedM.row(3).tail(3)\ =\ direction[0]*shapes.d1(0,\ 0)\ +\ direction[1]*shapes.d1(1,\ 0);}
\DoxyCodeLine{\ \ \ \ expectedM.row(4).tail(3)\ =\ direction[0]*shapes.d1(0,\ 0)\ +\ direction[1]*shapes.d1(1,\ 0);}
\DoxyCodeLine{\ \ \ \ expectedRhs[0]\ =\ v;}
\DoxyCodeLine{\ \ \ \ expectedRhs[1]\ =\ v\_row;}
\DoxyCodeLine{\ \ \ \ expectedRhs[3]\ =\ 2*v;}
\DoxyCodeLine{\ \ \ \ expectedRhs[4]\ =\ 2*v\_row;}
\DoxyCodeLine{\ \ \ \ op.grad(0,\ direction)\ =\ \{v,\ 2*v\};}
\DoxyCodeLine{\ \ \ \ op.grad(0,\ direction,\ 1)\ =\ \{v\_row,\ 2*v\_row\};}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedM\ -\/\ M).lpNorm<1>());}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ AssignNeumann)\ \{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\ direction(0.6,\ 0.8);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ v\ =\ 4.2,\ v\_row\ =\ 5.3;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedM\ =\ M;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedRhs\ =\ rhs;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ expectedM.row(0).head(3)\ =\ direction[0]*shapes.d1(0,\ 0)\ +\ direction[1]*shapes.d1(1,\ 0);}
\DoxyCodeLine{\ \ \ \ expectedM.row(1).head(3)\ =\ direction[0]*shapes.d1(0,\ 0)\ +\ direction[1]*shapes.d1(1,\ 0);}
\DoxyCodeLine{\ \ \ \ expectedM.row(3).tail(3)\ =\ direction[0]*shapes.d1(0,\ 0)\ +\ direction[1]*shapes.d1(1,\ 0);}
\DoxyCodeLine{\ \ \ \ expectedM.row(4).tail(3)\ =\ direction[0]*shapes.d1(0,\ 0)\ +\ direction[1]*shapes.d1(1,\ 0);}
\DoxyCodeLine{\ \ \ \ expectedRhs[0]\ =\ v;}
\DoxyCodeLine{\ \ \ \ expectedRhs[1]\ =\ v\_row;}
\DoxyCodeLine{\ \ \ \ expectedRhs[3]\ =\ 2*v;}
\DoxyCodeLine{\ \ \ \ expectedRhs[4]\ =\ 2*v\_row;}
\DoxyCodeLine{\ \ \ \ op.neumann(0,\ direction)\ =\ \{v,\ 2*v\};}
\DoxyCodeLine{\ \ \ \ op.neumann(0,\ direction,\ 1)\ =\ \{v\_row,\ 2*v\_row\};}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedM\ -\/\ M).lpNorm<1>());}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ AssignGradDiv)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ v\ =\ 4.2;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedM\ =\ M;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ expectedRhs\ =\ rhs;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ expectedM.row(0).head(3)\ =\ shapes.d2(0,\ 0,\ 0);\ \ \textcolor{comment}{//\ dxdx\ in\ node\ 0}}
\DoxyCodeLine{\ \ \ \ expectedM.row(0).tail(3)\ =\ shapes.d2(0,\ 1,\ 0);\ \ \textcolor{comment}{//\ dxdx\ in\ node\ 0}}
\DoxyCodeLine{\ \ \ \ expectedM.row(3).head(3)\ =\ shapes.d2(0,\ 1,\ 0);\ \ \textcolor{comment}{//\ dxdy\ in\ node\ 1}}
\DoxyCodeLine{\ \ \ \ expectedM.row(3).tail(3)\ =\ shapes.d2(1,\ 1,\ 0);\ \ \textcolor{comment}{//\ dydy\ in\ node\ 2}}
\DoxyCodeLine{\ \ \ \ expectedRhs[0]\ =\ v;}
\DoxyCodeLine{\ \ \ \ expectedRhs[3]\ =\ v;}
\DoxyCodeLine{\ \ \ \ op.graddiv(0)\ =\ v;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedM\ -\/\ M).lpNorm<1>());}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ AssignDeath)\ \{}
\DoxyCodeLine{\ \ \ \ EXPECT\_DEATH(op.lap(0)\ +\ op.lap(1)\ =\ 5,\ \textcolor{stringliteral}{"{}Cannot\ add\ together\ terms\ for\ different\ matrix\ rows"{}});}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST\_F(ImplicitVecOp,\ Syntax)\ \{}
\DoxyCodeLine{\ \ \ \ 0.0*op.lap(0,\ 0)\ +\ op.lap(0,\ 0)\ =\ 1;}
\DoxyCodeLine{\ \ \ \ op.lap(0,\ 1)\ +\ 0.0*op.lap(0,\ 1)\ =\ 1;}
\DoxyCodeLine{\ \ \ \ 0.25*op.lap(0,\ 2)\ +\ 0.75*op.lap(0,\ 2)\ =\ 1;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ 3;\ ++i)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ EXPECT\_EQ(M.row(i),\ M.row(0));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ EXPECT\_EQ(rhs.row(i),\ rhs.row(0));}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{TEST(Operators,\ ImplicitVectorComplexNumbers)\ \{}
\DoxyCodeLine{\ \ \ \ UniformShapeStorage<Vec2d>\ shapes;}
\DoxyCodeLine{\ \ \ \ shapes.resize(\{2,\ 2\});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ shapes.setSupport(0,\ \{0,\ 1\});}
\DoxyCodeLine{\ \ \ \ shapes.setSupport(1,\ \{0,\ 1\});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ Eigen::Vector2d\ s0(-\/0.12,\ 2.42),\ s1(0.34,\ 23.3);}
\DoxyCodeLine{\ \ \ \ std::vector<Eigen::Vector2d>\ s\ =\ \{s0,\ s1\};}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 2;\ ++i)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ shapes.setLaplace(i,\ s[i]);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ d1\ =\ 0;\ d1\ <\ 2;\ ++d1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ shapes.setD1(d1,\ i,\ s[i]);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ d2\ =\ d1;\ d2\ <\ 2;\ ++d2)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shapes.setD2(d1,\ d2,\ i,\ s[i]);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ Eigen::Matrix4cd\ M;\ M.setZero();}
\DoxyCodeLine{\ \ \ \ Eigen::Vector4cd\ rhs;\ rhs.setZero();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ op\ =\ shapes.implicitVectorOperators(M,\ rhs);}
\DoxyCodeLine{\ \ \ \ std::complex<double>\ c1(1.2,\ -\/3.4),\ c2(0.7,\ 8.9),\ c3(-\/5.6,\ 2.3);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ 1.6;}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\ dir(3.4,\ 2.3);}
\DoxyCodeLine{\ \ \ \ c1*op.lap(0)\ +\ c2*op.value(0)\ =\ \{c3,\ c1\};}
\DoxyCodeLine{\ \ \ \ op.grad(1,\ dir)\ +\ c1*op.graddiv(1)\ +\ x*op.lap(1)\ =\ \{c3,\ c1\};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ eq\ 1}}
\DoxyCodeLine{\ \ \ \ Eigen::Matrix4cd\ expectedM\ =\ M;}
\DoxyCodeLine{\ \ \ \ Eigen::Vector4cd\ expectedRhs\ =\ rhs;}
\DoxyCodeLine{\ \ \ \ expectedM.row(0).head(2)\ =\ c1*s0;}
\DoxyCodeLine{\ \ \ \ expectedM(0,\ 0)\ +=\ c2;}
\DoxyCodeLine{\ \ \ \ expectedRhs[0]\ =\ c3;}
\DoxyCodeLine{\ \ \ \ expectedM.row(2).tail(2)\ =\ c1*s0;}
\DoxyCodeLine{\ \ \ \ expectedM(2,\ 2)\ +=\ c2;}
\DoxyCodeLine{\ \ \ \ expectedRhs[2]\ =\ c1;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ EXPECT\_LT((expectedM\ -\/\ M).lpNorm<1>(),\ 3e-\/16);}
\DoxyCodeLine{\ \ \ \ EXPECT\_EQ(0,\ (expectedRhs\ -\/\ rhs).lpNorm<1>());}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST(Operators,\ implicit2dLaplaceOfvector)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Solve\ problem\ for\ F\ unknown\ vector\ field:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ (Laplace\ F)(x,\ y)\ =\ [4\ (1\ -\/\ 2\ pi\string^2\ y\string^2)\ sin(2\ pi\ x);\ 4\ (1\ -\/\ x\ -\/\ x\ y)\ e\string^(2\ y)]}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ on\ [0,\ 1]\ x\ [0,\ 1]\ with\ BC:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ F(x,\ 0)\ =\ [0,\ 1]}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ F(x,\ 1)\ =\ [2\ sin(2\ pi\ x),\ (1\ -\/\ x)\ e\string^2]}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ F(0,\ y)\ =\ [0,\ e\string^(2\ y)]}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ F(1,\ y)\ =\ [0,\ (1\ -\/\ y)\ e\string^(2\ y)]}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ with\ solution:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ F(x,\ y)\ =\ [2\ sin(2\ pi\ x)\ y\string^2,\ \ (1\ -\/\ x\ y)\ e\string^(2\ y)]}}
\DoxyCodeLine{\ \ \ \ std::function<\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}})>\ analytical\ =\ []\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\&\ p)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(\{2*std::sin(2*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*p[0])*p[1]*p[1],\ \ (1\ -\/\ p[0]*p[1])\ *\ std::exp(2*p[1])\});}
\DoxyCodeLine{\ \ \ \ \};}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Prepare\ domain}}
\DoxyCodeLine{\ \ \ \ BoxShape<Vec2d>\ box(0.,\ 1.);}
\DoxyCodeLine{\ \ \ \ DomainDiscretization<Vec2d>\ domain\ =\ box.discretizeWithStep(0.025);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ N\ =\ domain.size();}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ support\_size\ =\ 9;}
\DoxyCodeLine{\ \ \ \ domain.findSupport(FindClosest(support\_size));}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Prepare\ operators\ and\ matrix}}
\DoxyCodeLine{\ \ \ \ WLS<Monomials<Vec2d>,\ GaussianWeight<Vec2d>>\ wls(2,\ std::sqrt(15.0\ /\ N));}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ storage\ =\ domain.computeShapes(wls);}
\DoxyCodeLine{\ \ \ \ Eigen::SparseMatrix<double>\ M(2*N,\ 2*N);}
\DoxyCodeLine{\ \ \ \ M.reserve(storage.supportSizes()+storage.supportSizes());}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ rhs(2*N);\ rhs.setZero();}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ op\ =\ storage.implicitVectorOperators(M,\ rhs);}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ equation\ on\ interior}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.interior())\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0),\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.lap(i)\ =\ \{4\ *\ (1\ -\/\ 2\ *\ \mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}\ *\ y*y)\ *\ std::sin(2\ *\ \mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}\ *\ x),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4\ *\ (1\ -\/\ x\ -\/\ x\ *\ y)\ *\ std::exp(2\ *\ y)\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ boundary\ conditions}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{0,\ std::exp(2*y)\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/2)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{0,\ (1-\/y)\ *\ std::exp(2*y)\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/3)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{0,\ 1\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/4)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{2\ *\ std::sin(2\ *\ \mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}\ *\ x),\ (1\ -\/\ x)\ *\ std::exp(2)\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Sparse\ solve}}
\DoxyCodeLine{\ \ \ \ M.makeCompressed();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ Eigen::SparseLU<Eigen::SparseMatrix<double>>\ solver;}
\DoxyCodeLine{\ \ \ \ solver.compute(M);}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ sol\ =\ solver.solve(rhs);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ ++i)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\ correct\ =\ analytical(domain.pos(i));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ EXPECT\_NEAR(sol[i],\ correct[0],\ 1e-\/3);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ EXPECT\_NEAR(sol[N+i],\ correct[1],\ 1e-\/3);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST(Operators,\ Implicit2dGradOfVector)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Solve\ problem\ for\ u\ unknown\ vector\ field:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ grad\ u\ .\ v\ +\ 1/2\ laplace\ u\ =\ f}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ grad\ u\ .\ (y,\ x)\ +\ 1/2\ laplace\ u\ =\ (x\string^3+y+2\ x\ y\string^2,\ x\string^2+(y-\/1)\ y)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ on\ [0,\ 1]\ x\ [0,\ 1]\ with\ BC:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(x,\ 0)\ =\ (0,\ -\/x)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(x,\ 1)\ =\ (x*x,\ 0)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(0,\ y)\ =\ (0,\ 0)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(1,\ y)\ =\ (y,\ y-\/1)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ with\ solution:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(x,\ y)\ =\ (x\string^2\ y,\ yx\ -\/\ x)}}
\DoxyCodeLine{\ \ \ \ std::function<\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}})>\ analytical\ =\ []\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\&\ p)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(p[0]*p[0]*p[1],\ (p[1]-\/1)*p[0]);}
\DoxyCodeLine{\ \ \ \ \};}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Prepare\ domain}}
\DoxyCodeLine{\ \ \ \ BoxShape<Vec2d>\ box(0.,\ 1.);}
\DoxyCodeLine{\ \ \ \ DomainDiscretization<Vec2d>\ domain\ =\ box.discretizeWithStep(0.05);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ N\ =\ domain.size();}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ support\_size\ =\ 9;}
\DoxyCodeLine{\ \ \ \ domain.findSupport(FindClosest(support\_size));}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Prepare\ operators\ and\ matrix}}
\DoxyCodeLine{\ \ \ \ WLS<Monomials<Vec2d>,\ GaussianWeight<Vec2d>>\ wls(2,\ 15.0\ /\ N);}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ storage\ =\ domain.computeShapes(wls);}
\DoxyCodeLine{\ \ \ \ Eigen::SparseMatrix<double>\ M(2*N,\ 2*N);}
\DoxyCodeLine{\ \ \ \ M.reserve(storage.supportSizes()+storage.supportSizes());}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ rhs(2*N);\ rhs.setZero();}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ op\ =\ storage.implicitVectorOperators(M,\ rhs);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ Range<Vec2d>\ v(N);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ ++i)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ v[i]\ =\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(\{domain.pos(i,\ 1),\ domain.pos(i,\ 0)\});}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ equation\ on\ interior}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.interior())\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0),\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.grad(i,\ v[i])\ +\ 0.5*op.lap(i)\ =\ \{x*x*x\ +\ y\ +\ 2*x*y*y,\ x*x\ +\ (y-\/1)*y\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ boundary\ conditions}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ 0;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/2)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{y,\ y-\/1\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/3)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{0,\ -\/x\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/4)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{x*x,\ 0\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Sparse\ solve}}
\DoxyCodeLine{\ \ \ \ Eigen::BiCGSTAB<Eigen::SparseMatrix<double,\ Eigen::RowMajor>>\ solver;}
\DoxyCodeLine{\ \ \ \ solver.compute(M);}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ sol\ =\ solver.solve(rhs);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ ++i)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\ correct\ =\ analytical(domain.pos(i));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ASSERT\_NEAR(sol[i],\ correct[0],\ 1e-\/3);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ASSERT\_NEAR(sol[i+N],\ correct[1],\ 1e-\/3);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST(Operators,\ Implicit2dGradDiv)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Solve\ problem\ for\ u\ unknown\ vector\ field:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ grad\ div\ u\ +\ laplace\ u\ =\ (2\ +\ 4xy\ -\/\ 8pi\string^2sin(2*pi*x),\ 2(2x\string^2+y\string^2))}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ on\ [0,\ 1]\ x\ [0,\ 1]\ with\ BC:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(0,\ y)\ =\ (y\string^2,\ 0)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(1,\ y)\ =\ (y\string^2,\ y\string^2)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(x,\ 0)\ =\ (sin(2*pi*x),\ 0)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(x,\ 1)\ =\ (1+sin(2*pi*x,\ x\string^2)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ with\ solution:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u(x,\ y)\ =\ (y\string^2\ +\ sin(2*pi*x),\ x\string^2y\string^2)}}
\DoxyCodeLine{\ \ \ \ std::function<\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}})>\ analytical\ =\ []\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\&\ p)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(\{p[1]*p[1]+std::sin(2*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*p[0]),\ p[0]*p[0]*p[1]*p[1]\});}
\DoxyCodeLine{\ \ \ \ \};}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Prepare\ domain}}
\DoxyCodeLine{\ \ \ \ BoxShape<Vec2d>\ box(0.,\ 1.);}
\DoxyCodeLine{\ \ \ \ DomainDiscretization<Vec2d>\ domain\ =\ box.discretizeWithStep(0.025);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ N\ =\ domain.size();}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ support\_size\ =\ 6;}
\DoxyCodeLine{\ \ \ \ domain.findSupport(FindClosest(support\_size));}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Prepare\ operators\ and\ matrix}}
\DoxyCodeLine{\ \ \ \ WLS<Monomials<Vec2d>,\ GaussianWeight<Vec2d>>\ wls(2,\ std::sqrt(15.0\ /\ N));}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ storage\ =\ domain.computeShapes<\mbox{\hyperlink{namespacemm_1_1sh_a60b0e1ba4d8f14cf84bd2e385816e6bd}{sh::graddiv}}|\mbox{\hyperlink{namespacemm_1_1sh_a434ea4fc68d98db4d13d50adf7915ac0}{sh::lap}}>(wls,\ domain.interior());}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ Eigen::SparseMatrix<double,\ Eigen::RowMajor>\ M(2*N,\ 2*N);}
\DoxyCodeLine{\ \ \ \ M.reserve(Range<int>(2*N,\ support\_size));}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ rhs(2*N);\ rhs.setZero();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ op\ =\ storage.implicitVectorOperators(M,\ rhs);}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ equation\ on\ interior}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.interior())\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0),\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.lap(i)\ +\ op.graddiv(i)\ =\ \{2+4*x*y-\/8*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*std::sin(2*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*x),\ 2*(2*x*x\ +\ y*y)\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ boundary\ conditions}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{y*y,\ 0\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/2)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{y*y,\ y*y\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/3)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{std::sin(2*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*x),\ 0\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/4)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{1+std::sin(2*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*x),\ x*x\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Sparse\ solve}}
\DoxyCodeLine{\ \ \ \ Eigen::BiCGSTAB<Eigen::SparseMatrix<double,\ Eigen::RowMajor>>\ solver;}
\DoxyCodeLine{\ \ \ \ solver.compute(M);}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ sol\ =\ solver.solve(rhs);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ ++i)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\ correct\ =\ analytical(domain.pos(i));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ EXPECT\_NEAR(sol[i],\ correct[0],\ 0.8e-\/2);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ EXPECT\_NEAR(sol[i+N],\ correct[1],\ 0.8e-\/2);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST(Operators,\ ImplicitDer1Sum)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ The\ vector\ field\ is\ given\ by:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u\ =\ u\_0*(sin(pi*(x\string^2+y\string^2))+1)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ v\ =\ v\_0*(cos(pi*(x\string^2+y\string^2))+1)}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ The\ derivatives\ are\ given\ by:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u\_x\ =\ 2*pi*u\_0*x*cos(pi*(x\string^2+y\string^2))}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ u\_y\ =\ 2*pi*u\_0*y*cos(pi*(x\string^2+y\string^2))}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ v\_x\ =\ -\/2*pi*v\_0*x*sin(pi*(x\string^2+y\string^2))}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ v\_y\ =\ -\/2*pi*v\_0*y*sin(pi*(x\string^2+y\string^2))}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ u0\ =\ 1,\ v0\ =\ 1;}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ alpha\ =\ 1,\ beta\ =\ 1,\ gamma\ =\ 1,\ delta\ =\ 1;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Vector\ field\ function\ that\ returns\ (u,v)}}
\DoxyCodeLine{\ \ \ \ std::function<\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}})>\ analytical\ =\ [\&u0,\ \&v0]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\&\ p)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}(\{u0*(std::sin(p.squaredNorm())+1),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v0*(std::cos(p.squaredNorm())+1)\});}
\DoxyCodeLine{\ \ \ \ \};}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Analytical\ function\ for\ \(\backslash\)alpha*u\_x\ +\ \(\backslash\)beta*v\_y}}
\DoxyCodeLine{\ \ \ \ std::function<double(\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}})>\ tx\ =\ [\&alpha,\ \&beta,\ \&u0,\ \&v0]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\&\ p)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ alpha*(2*u0*p[0]*std::cos(p.squaredNorm()))\ +}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta*(-\/2*v0*p[1]*std::sin(p.squaredNorm()));}
\DoxyCodeLine{\ \ \ \ \};}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Analytical\ function\ for\ \(\backslash\)gamma*u\_y\ +\ \(\backslash\)delta*v\_x}}
\DoxyCodeLine{\ \ \ \ std::function<double(\mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}})>\ ty\ =\ [\&gamma,\ \&delta,\ \&u0,\ \&v0]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacemm_a3cf09fb5c30d93f0cfb30d80f0b8c6cf}{Vec2d}}\&\ p)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ gamma*(2*u0*p[1]*std::cos(p.squaredNorm()))\ +}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delta*(-\/2*v0*p[0]*std::sin(p.squaredNorm()));}
\DoxyCodeLine{\ \ \ \ \};}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Create\ and\ fill\ domain}}
\DoxyCodeLine{\ \ \ \ BoxShape<Vec2d>\ box(\{-\/0.2,\ -\/0.5\},\ \{0.8,\ 0.5\});}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ step\ =\ 0.01;}
\DoxyCodeLine{\ \ \ \ DomainDiscretization<Vec2d>\ domain\ =\ box.discretizeWithStep(step);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ support\_size\ =\ 12;}
\DoxyCodeLine{\ \ \ \ domain.findSupport(FindClosest(support\_size));}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ N\ =\ domain.size();}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Prepare\ MLS\ engine}}
\DoxyCodeLine{\ \ \ \ WLS<Monomials<Vec2d>,\ GaussianWeight<Vec2d>>\ wls(2,\ step);}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ storage\ =\ domain.computeShapes<\mbox{\hyperlink{namespacemm_1_1sh_abc1e7a707374c7118eb32cad985682fb}{sh::d1}}>(wls);}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Fill\ Matrix\ with\ operators\ for}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ \(\backslash\)alpha*u\_x\ +\ \(\backslash\)beta*v\_y\ in\ x-\/direction\ and}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ \(\backslash\)gamma*u\_y\ +\ \(\backslash\)delta*v\_x\ in\ y-\/direction}}
\DoxyCodeLine{\ \ \ \ Eigen::SparseMatrix<double,\ Eigen::RowMajor>\ M(2\ *\ N,\ 2\ *\ N);}
\DoxyCodeLine{\ \ \ \ M.reserve(Range<int>(2\ *\ N,\ 2\ *\ support\_size));}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ field(2\ *\ N),\ rhs(2\ *\ N);}
\DoxyCodeLine{\ \ \ \ rhs.setZero();}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ op\ =\ storage.implicitVectorOperators(M,\ rhs);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ ++i)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ in\ x-\/direction}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ alpha*op.eq(0).c(0).der1(i,\ 0)\ +\ beta*op.eq(0).c(1).der1(i,\ 1)\ =\ tx(domain.pos(i));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ in\ y-\/direction}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ gamma*op.eq(1).c(0).der1(i,\ 1)\ +\ delta*op.eq(1).c(1).der1(i,\ 0)\ =\ ty(domain.pos(i));}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ f\ =\ analytical(domain.pos(i));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ field(i)\ =\ f[0];}
\DoxyCodeLine{\ \ \ \ \ \ \ \ field(i+N)\ =\ f[1];}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ perform\ multiplication}}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ prod\ =\ M*field;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ check\ both\ components\ are\ close\ enough}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ ++i)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ASSERT\_NEAR(prod[i],\ rhs[i],\ 1e-\/3);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ASSERT\_NEAR(prod[i+N],\ rhs[i+N],\ 1e-\/3);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{TEST(Operators,\ DISABLED\_ImplicitVectorOperatorsUsageExample)\ \{}
\DoxyCodeLine{\ \ \ \ BoxShape<Vec2d>\ box(\{-\/0.2,\ -\/0.5\},\ \{0.8,\ 0.5\});}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{double}\ step\ =\ 0.01;}
\DoxyCodeLine{\ \ \ \ DomainDiscretization<Vec2d>\ domain\ =\ box.discretizeWithStep(step);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ support\_size\ =\ 12;}
\DoxyCodeLine{\ \ \ \ domain.findSupport(FindClosest(support\_size));}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ N\ =\ domain.size();}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Prepare\ MLS\ engine}}
\DoxyCodeLine{\ \ \ \ WLS<Monomials<Vec2d>,\ GaussianWeight<Vec2d>>\ wls(2,\ step);}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ storage\ =\ domain.computeShapes(wls);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ Eigen::SparseMatrix<double,\ Eigen::RowMajor>\ M(2\ *\ N,\ 2\ *\ N);}
\DoxyCodeLine{\ \ \ \ M.reserve(Range<int>(2\ *\ N,\ 2\ *\ support\_size));}
\DoxyCodeLine{\ \ \ \ Eigen::VectorXd\ field(2\ *\ N),\ rhs(2\ *\ N);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ op\ =\ storage.implicitVectorOperators(M,\ rhs);}
\DoxyCodeLine{\ \ \ \ std::cout\ <<\ op\ <<\ std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ equation\ on\ interior}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.interior())\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0),\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.lap(i)\ +\ op.graddiv(i)\ =\ \{2+4*x*y-\/8*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*std::sin(2*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*x),\ 2*(2*x*x\ +\ y*y)\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Set\ boundary\ conditions}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{y*y,\ 0\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/2)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ y\ =\ domain.pos(i,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{y*y,\ y*y\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/3)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{std::sin(2*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*x),\ 0\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ :\ domain.types()\ ==\ -\/4)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ x\ =\ domain.pos(i,\ 0);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ op.value(i)\ =\ \{1+std::sin(2*\mbox{\hyperlink{namespacemm_add5120ca222cb67674865bb4ea92cfae}{PI}}*x),\ x*x\};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \ \textcolor{comment}{//\ namespace\ mm}}

\end{DoxyCodeInclude}
 